#!/bin/bash
# -----------------------------------------------------------------------------
# docker-minecraft /start script
# -----------------------------------------------------------------------------

cd /data/;
if ! [[ -f forge-1.18.2-40.2.26-installer.jar ]]; then
    rm -rf .
    curl -o 'forge-1.18.2-40.2.26-installer.jar' 'https://maven.minecraftforge.net/net/minecraftforge/forge/1.18.2-40.2.26/forge-1.18.2-40.2.26-installer.jar'
    java -jar forge-1.18.2-40.2.26-installer.jar --installServer
fi
if ! [[ -d mods ]]; then
    curl -o 'release.zip' 'https://github.com/brandongohwh/Custom1.18/archive/refs/tags/Release.zip'
    unzip 'release.zip'
    mv release/Custom1.18-Release/* .
if [[ -n "$MOTD" ]]; then
    sed -i "/motd\s*=/ c motd=$MOTD" /data/server.properties
fi
if [[ -n "$LEVEL" ]]; then
    sed -i "/level-name\s*=/ c level-name=$LEVEL" /data/server.properties
fi
if [[ -n "$OPS" ]]; then
    echo $OPS | awk -v RS=, '{print}' >> ops.txt
fi


if [ ! -f /data/eula.txt ]
then
    echo "eula=true" > /data/eula.txt
fi

sh run.sh
