#!/bin/bash
# -----------------------------------------------------------------------------
# docker-minecraft /start script
# -----------------------------------------------------------------------------

cd /data/;
if ! [[ -f serverinstall_95_6434 ]]; then
    rm -f serverinstall_* forge-*.jar
    curl -o 'serverinstall_95_6434' 'https://api.feed-the-beast.com/v1/modpacks/public/server/installer?platform=ftb&packId=95&versionId=6434&os=linux'
    chmod +x serverinstall_95_6434
    ./serverinstall_95_6434 --dir /data --auto --force
fi
if [[ -n "$MOTD" ]]; then
    sed -i "/motd\s*=/ c motd=$MOTD" /data/server.properties
fi
if [[ -n "$LEVEL" ]]; then
    sed -i "/level-name\s*=/ c level-name=$LEVEL" /data/server.properties
fi
if [[ -n "$OPS" ]]; then
    echo $OPS | awk -v RS=, '{print}' >> ops.txt
fi


if [ ! -f /data/eula.txt ]
then
    echo "eula=true" > /data/eula.txt
fi

sh run.sh
